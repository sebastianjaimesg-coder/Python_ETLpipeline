ğŸ“Š Technical Test â€“ Data Engineer

This project is the solution to a technical test for the role of Data Engineer, with the goal of analyzing, cleaning, validating, and exporting a hospital dataset originally in JSON format.

ğŸ“‚ Project Structure
prueba_tecnica_ing_datos/
â”‚
â”œâ”€ data/
â”‚   â”œâ”€ raw/        # Original data (JSON)
â”‚   â”œâ”€ interim/    # Intermediate data generated by explore.py
â”‚   â””â”€ clean/      # Final cleaned data
â”‚
â”œâ”€ reports/        # Exploration, cleaning, and validation reports
â”‚
â”œâ”€ src/            # Python scripts
â”‚   â”œâ”€ explore.py       # Initial dataset exploration
â”‚   â”œâ”€ clean.py         # Cleaning and validation
â”‚   â”œâ”€ export_excel.py  # Export cleaned dataset to Excel
â”‚   â”œâ”€ compare.py       # Quality comparison before/after cleaning
â”‚   â””â”€ load_to_dw.py    # Data Warehouse load simulation
â”‚
â”œâ”€ tests/          # Automated data quality tests
â”‚
â”œâ”€ requirements.txt
â””â”€ README.md

âš™ï¸ Requirements

Python 3.10+

Libraries:

pandas

numpy

python-dateutil

openpyxl

pyarrow

Installation:

pip install -r requirements.txt

ğŸš€ Step-by-Step Execution
1ï¸âƒ£ Place the original file

Save dataset_hospital.json in data/raw/.

2ï¸âƒ£ Data exploration
python src/explore.py


Outputs:

Intermediate CSV files (pacientes_raw.csv, citas_medicas_raw.csv) in data/interim/

exploration_report.md in reports/

3ï¸âƒ£ Data cleaning and validation
python src/clean.py


Outputs:

Clean CSV files in data/clean/

cleaning_summary.md and orphan_citas.csv in reports/

4ï¸âƒ£ Export to Excel
python src/export_excel.py


Output:

hospital_dataset_clean.xlsx in data/

5ï¸âƒ£ Data Warehouse load simulation
python src/load_to_dw.py


Loads cleaned data into a SQLite target structure with:

dim_pacientes

fact_citas

ğŸ§¹ Cleaning Process Overview

Detected issues:

Patients: duplicates by id_paciente, null values in edad, sexo, email, telefono, ciudad.

Appointments: null values in fecha_cita, especialidad, medico, costo, estado_cita; 190 orphan records (nonexistent patient IDs).

Actions taken:

Standardized date format (YYYY-MM-DD)

Recalculated age from fecha_nacimiento

Normalized gender (M / F)

Removed duplicates (id_paciente)

Referential integrity check (orphan appointments logged in orphan_citas.csv)

ğŸ“ˆ Data Quality Indicators
Table	Initial rows	Final rows	Initial null values	Final null values	Initial duplicates	Final duplicates
pacientes	5,010	5,000	7,671	6,021	10	0
citas_medicas	9,961	9,961	11,250	11,250	0	0
âœ… Automated Validation

Tests executed using pytest (tests/test_data_quality.py):

No duplicate IDs in patients or appointments

All patient IDs are valid

Referential integrity between appointments and patients

All required columns are present

Result: All tests passed successfully.

ğŸ“¦ Deliverables

Data:

data/raw/dataset_hospital.json â†’ Original source

data/interim/ â†’ Intermediate data

data/clean/ â†’ Cleaned data

data/hospital_dataset_clean.xlsx â†’ Final consolidated dataset

Reports:

exploration_report.md

cleaning_summary.md

orphan_citas.csv

final_report.md (this technical document)

Scripts: explore.py, clean.py, export_excel.py, compare.py, load_to_dw.py

ğŸ’¡ Recommendations for Improvement

Fill in missing key fields from external sources.

Review and correct orphan appointments.

Standardize specialty and physician names.

Define business rules to impute costo and estado_cita.
